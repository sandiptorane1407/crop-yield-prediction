# -*- coding: utf-8 -*-
"""ClassifyColumn.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1g9dX3MNVlQMRSCeIBKv23oyQZn-uOE-z
"""

# Commented out IPython magic to ensure Python compatibility.
from google.colab import drive
drive.mount('/gdrive')
# %cd /gdrive

import pandas as pd
import keras 
import tensorflow as tf
from keras import models
from keras import layers 
import numpy as np
import matplotlib.pyplot as plt
from keras.utils import to_categorical
from keras import optimizers
from keras.layers import Conv1D,Flatten,Dropout
from keras.models import model_from_json
import numpy as np

train=pd.read_csv('/gdrive/My Drive/Colab Notebooks/megaproject2/Datasets/original_dataset.csv')
train

train=train.dropna()
train=train[train['Production'] >= 1]
train=train[train['Area'] >=1]
train=train[train['Crop_Year'] <2015]
train=train[train['Production']<=20000000]
train=train[train['Area']<=1800000]

State=train.State_Name.unique()
print(State)
State.shape

df=pd.DataFrame(State)
df.to_csv('/gdrive/My Drive//SEMVII/mp/state.csv')    #save state.csv to drive

District=train.District_Name.unique()

District.shape

District.sort()
District

df=pd.DataFrame(District)
df.to_csv('/gdrive/My Drive//SEMVII/mp/district.csv',index=False)   #save district.csv to drive

crop=train.Crop.unique()
print(crop)
crop.shape

crop.sort()
crop

df=pd.DataFrame(crop)
df.to_csv('/gdrive/My Drive//SEMVII/mp/crop.csv',index=False) #save crop.csv to drive

season=train.Season.unique()
print(season)

season.sort()
season

df=pd.DataFrame(season)
df.to_csv('/gdrive/My Drive//SEMVII/mp/season.csv',index=False,) #save season.csv to drive

data=pd.read_csv('/gdrive/My Drive//SEMVII/mp/crop.csv')
data

df=pd.DataFrame(train)
df=df.drop_duplicates(subset="District_Name")
df.to_csv('/gdrive/My Drive//SEMVII/mp/statewithdistrict.csv',index=False) #save statewithdistrict.csv to drive
df

df=pd.DataFrame(train)
df=df.drop_duplicates(subset="Crop")
df=df.drop('State_Name',axis=1)
df=df.drop('District_Name',axis=1)
df=df.drop('Area',axis=1)
df=df.drop('Crop_Year',axis=1)
df=df.drop('Production',axis=1)
df=df.sort_values(by=['Season','Crop'],axis=0)
df.to_csv('/gdrive/My Drive//SEMVII/mp/seasonwisecrop.csv',index=False)
df